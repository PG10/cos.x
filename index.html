<!DOCTYPE html>
<html>
<head>
    <title>LED Fixture Model</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
        body { margin: 0; overflow: hidden; }
        canvas { display: block; }
    </style>
</head>
<body>
    <script src="./js/three.min.js"></script>
    <script src="./js/GLTFLoader.js"></script>
    <script src="./js/RGBELoader.js"></script>
    <script src="./js/DRACOLoader.js"></script>
    <script src="./js/OrbitControls.js"></script>

    <script>
        // --- FILE PATHS (All 8 Components) ---
        const BANDS_MODEL_PATH      = '/cos.x/bands.glb';
        const FEEDS_MODEL_PATH      = '/cos.x/feeds.glb';
        const GRIPPER_MODEL_PATH    = '/cos.x/gripper.glb';
        const HOLDER_MODEL_PATH     = '/cos.x/holder.glb';
        const LENS_MODEL_PATH       = '/cos.x/lens.glb';
        const SHADE_MODEL_PATH      = '/cos.x/shade.glb';
        const SINK_MODEL_PATH       = '/cos.x/sink.glb';    
        const SUSPENSION_MODEL_PATH = '/cos.x/suspension.glb';
        
        let scene, camera, renderer, controls;
        let models = {}; 

        function init() {
            // Setup Renderer
            renderer = new THREE.WebGLRenderer({ antialias: true });
            renderer.setSize(window.innerWidth, window.innerHeight);
            
            renderer.toneMapping = THREE.ACESFilmicToneMapping;
            renderer.toneMappingExposure = 0.5; 
            renderer.outputColorSpace = THREE.SRGBColorSpace; 
            
            renderer.setClearColor(0xffffff); 
            document.body.appendChild(renderer.domElement);

            // Setup Scene and Camera
            scene = new THREE.Scene();
            camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 5000); 
            camera.position.set(0.0, 10.0, 100.0); 
            
            // Add Lights 
            const ambientLight = new THREE.AmbientLight(0xffffff, 0.5); 
            scene.add(ambientLight);

            const ledLight = new THREE.PointLight(0xffeebb, 1000, 500); 
            ledLight.position.set(0, 5, 0); 
            scene.add(ledLight);
            
            // OrbitControls Setup
            controls = new THREE.OrbitControls(camera, renderer.domElement);
            controls.target.set(0, 0, 0); 
            controls.minDistance = 10.0; 
            controls.maxDistance = 200.0; 
            controls.enableDamping = true;
            controls.update();
            
            loadAllModels(); 

            window.addEventListener('resize', onWindowResize, false);
            animate();
        }

        function loadAllModels() {
            const dracoLoader = new THREE.DRACOLoader();
            dracoLoader.setDecoderPath('/cos.x/draco/'); 
            const gltfLoader = new THREE.GLTFLoader();
            gltfLoader.setDRACOLoader(dracoLoader);

            let modelsLoaded = 0;
            const totalModels = 8;
            const modelPaths = {
                'sink': SINK_MODEL_PATH,
                'shade': SHADE_MODEL_PATH,
                'bands': BANDS_MODEL_PATH,
                'feeds': FEEDS_MODEL_PATH,
                'gripper': GRIPPER_MODEL_PATH,
                'holder': HOLDER_MODEL_PATH,
                'lens': LENS_MODEL_PATH,
                'suspension': SUSPENSION_MODEL_PATH
            };

            const onModelLoaded = (gltf, modelName) => {
                const loadedModel = gltf.scene;
                
                loadedModel.traverse((child) => {
                    if (child.isMesh) {
                        const material = child.material;
                        
                        // Reset properties
                        material.transparent = false;
                        material.opacity = 1.0;
                        material.emissive.set(0x000000);
                        material.emissiveIntensity = 0.0;
                        material.needsUpdate = true;
                        
                        // ---